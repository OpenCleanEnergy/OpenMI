Version 4
SHEET 1 2192 680
WIRE -16 -864 -64 -864
WIRE -64 -832 -64 -864
WIRE -64 -720 -64 -752
WIRE -16 -672 -64 -672
WIRE -64 -640 -64 -672
WIRE -64 -528 -64 -560
WIRE 960 -400 448 -400
WIRE 1248 -400 1120 -400
WIRE 1376 -400 1312 -400
WIRE 1504 -400 1376 -400
WIRE 1664 -400 1584 -400
WIRE -16 -368 -64 -368
WIRE 1664 -352 1664 -400
WIRE -64 -336 -64 -368
WIRE 960 -320 864 -320
WIRE 1216 -320 1120 -320
WIRE 960 -240 800 -240
WIRE 1248 -240 1120 -240
WIRE 1376 -240 1376 -400
WIRE 1376 -240 1312 -240
WIRE 1664 -240 1664 -272
WIRE -64 -224 -64 -256
WIRE 448 -224 448 -400
WIRE 800 -224 800 -240
WIRE 448 -192 448 -224
WIRE 800 -192 800 -224
WIRE 400 -112 352 -112
WIRE 752 -112 704 -112
WIRE 448 -64 448 -96
WIRE 800 -64 800 -96
WIRE 880 80 880 32
WIRE 992 80 992 32
WIRE 112 128 64 128
WIRE 400 128 352 128
WIRE 64 160 64 128
WIRE 352 160 352 128
WIRE 880 176 880 160
WIRE 992 176 992 160
WIRE 880 256 880 240
WIRE 992 256 992 240
WIRE 64 272 64 240
WIRE 352 272 352 240
FLAG 112 128 sine
FLAG 64 272 0
FLAG 400 128 steps
FLAG 352 272 0
FLAG -16 -864 pwm1
FLAG -64 -720 0
FLAG -16 -672 pwm2
FLAG -64 -528 0
FLAG 448 -64 0
FLAG 800 -64 0
FLAG 352 -112 pwm1
FLAG 704 -112 pwm2
FLAG 1216 -320 0
FLAG 864 -320 in
FLAG 1664 -240 0
FLAG 1664 -400 out
FLAG -64 -224 0
FLAG -16 -368 in
FLAG 448 -224 ds1
FLAG 800 -224 ds2
FLAG 880 256 in
FLAG 992 256 in
FLAG 880 32 ds1
FLAG 992 32 ds2
SYMBOL voltage 64 144 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PWL file=sine.txt
SYMBOL voltage 352 144 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PWL file=steps.txt
SYMBOL voltage -64 -848 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 44 Left 2
SYMATTR InstName V3
SYMATTR Value PULSE(0 {Vgs} 1u {ts} {ts} 2.5u 10u)
SYMBOL voltage -64 -656 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 44 Left 2
SYMATTR InstName V4
SYMATTR Value PULSE(0 {Vgs} 6u {ts} {ts} 2.5u 10u)
SYMBOL ind2 944 -416 R0
SYMATTR InstName L1
SYMATTR Value {Lp}
SYMATTR Type ind
SYMBOL ind2 1136 -416 M0
SYMATTR InstName L2
SYMATTR Value {Ls}
SYMATTR Type ind
SYMBOL ind2 944 -336 R0
SYMATTR InstName L3
SYMATTR Value {Lp}
SYMATTR Type ind
SYMBOL ind2 1136 -336 M0
SYMATTR InstName L4
SYMATTR Value {Ls}
SYMATTR Type ind
SYMBOL nmos 400 -192 R0
SYMATTR InstName M1
SYMATTR Value IPT015N10N5
SYMBOL nmos 752 -192 R0
SYMATTR InstName M2
SYMATTR Value IPT015N10N5
SYMBOL diode 1248 -384 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value IdealDiode
SYMBOL diode 1248 -224 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value IdealDiode
SYMBOL res 1648 -368 R0
SYMATTR InstName R1
SYMATTR Value 1kR
SYMBOL voltage -64 -352 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 40V
SYMBOL cap 864 176 R0
SYMATTR InstName C1
SYMATTR Value {Cs}
SYMBOL cap 976 176 R0
SYMATTR InstName C2
SYMATTR Value {Cs}
SYMBOL res 864 64 R0
SYMATTR InstName R2
SYMATTR Value {Rs}
SYMBOL res 976 64 R0
SYMATTR InstName R3
SYMATTR Value {Rs}
SYMBOL ind 1488 -384 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L5
SYMATTR Value 1m
TEXT 32 296 Left 2 !.tran 0 100u 0 10n
TEXT 960 -456 Left 2 !K1 L1 L2 L3 L4 {1-1e-6}
TEXT -64 -456 Left 2 !.param Vgs=15V
TEXT 960 -528 Left 2 !.param Lp=100mH
TEXT 960 -560 Left 2 !.param N=20
TEXT 960 -496 Left 2 !.param Ls=Lp*N**2
TEXT 1344 -624 Left 2 !.model IdealDiode D(Ron=1u Roff=1Meg Vfwd=0.1 Vrev=1Meg)
TEXT -8 -800 Left 2 ;PWL REPEAT FOREVER VALUE_SCALE_FACTOR={Vgs} (file=pwm-1.txt)
TEXT -16 -608 Left 2 ;PWL REPEAT FOREVER VALUE_SCALE_FACTOR={Vgs} (file=pwm-2.txt)
TEXT 816 320 Left 2 !.param Cs=7.2n
TEXT 1160 40 Left 2 ;https://www.analog.com/en/design-notes/ccfl-pushpull-snubber-circuit.html\nResonent frequency f=10MHz\nCs=3.6n halfes the resonant frequency -> the parasitic capacitance is about 1.2n\nParasitic inductance L=211nH\nCharacteristic impedance: Z=13.26 (ideal value for the "double voltage" edge)\nBy stepping through different Rs values, Rs=7 is the best tradeoff for all three edges
TEXT 816 352 Left 2 !.meas Ps AVG ABS(I(R2))
TEXT -312 -512 Left 2 !.param ts=10n
TEXT 1056 320 Left 2 !.param Rs 7
