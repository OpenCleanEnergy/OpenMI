Version 4
SHEET 1 3940 1956
WIRE -64 -288 -144 -288
WIRE -144 -256 -144 -288
WIRE -144 -144 -144 -176
WIRE -96 -64 -144 -64
WIRE 48 -64 -96 -64
WIRE 272 -64 48 -64
WIRE 48 -48 48 -64
WIRE 272 -48 272 -64
WIRE -144 16 -144 -64
WIRE 48 48 48 32
WIRE 128 48 48 48
WIRE 272 48 272 32
WIRE 368 48 272 48
WIRE 656 48 528 48
WIRE 800 48 720 48
WIRE 960 48 880 48
WIRE 1136 48 960 48
WIRE 1168 48 1136 48
WIRE 48 64 48 48
WIRE 272 64 272 48
WIRE 960 64 960 48
WIRE 1168 64 1168 48
WIRE -144 160 -144 96
WIRE -80 160 -144 160
WIRE 48 160 48 144
WIRE 48 160 -80 160
WIRE 272 160 272 144
WIRE 272 160 48 160
WIRE 960 160 960 144
WIRE 960 160 528 160
WIRE 1168 160 1168 144
WIRE 1168 160 960 160
WIRE -144 176 -144 160
WIRE -144 272 -144 256
WIRE 48 368 -144 368
WIRE 272 368 48 368
WIRE 48 384 48 368
WIRE 272 384 272 368
WIRE -144 448 -144 368
WIRE 48 480 48 464
WIRE 128 480 48 480
WIRE 272 480 272 464
WIRE 368 480 272 480
WIRE 656 480 528 480
WIRE 768 480 720 480
WIRE 1120 480 992 480
WIRE 1168 480 1120 480
WIRE 48 496 48 480
WIRE 272 496 272 480
WIRE 768 496 768 480
WIRE 992 496 992 480
WIRE 1168 496 1168 480
WIRE -144 592 -144 528
WIRE 48 592 48 576
WIRE 48 592 -144 592
WIRE 272 592 272 576
WIRE 272 592 48 592
WIRE 768 592 768 576
WIRE 768 592 528 592
WIRE 992 592 992 576
WIRE 1168 592 1168 576
WIRE 1168 592 992 592
WIRE -144 608 -144 592
WIRE 1168 608 1168 592
WIRE -144 704 -144 688
FLAG -144 272 0
FLAG 528 48 P_1
FLAG 1136 48 V_r
FLAG 1168 688 0
FLAG 1120 480 V_0
FLAG -144 704 0
FLAG -80 160 GND1
FLAG -144 -144 0
FLAG -64 -288 sw
FLAG 0 16 0
FLAG 0 -32 sw
FLAG 0 128 0
FLAG 0 80 sw
FLAG -96 -64 v_in
FLAG 224 16 0
FLAG 224 -32 sw
FLAG 224 128 0
FLAG 224 80 sw
FLAG 128 48 P_1
FLAG 368 48 N_1
FLAG 528 160 N_1
FLAG 0 448 0
FLAG 0 400 sw
FLAG 0 560 0
FLAG 0 512 sw
FLAG 224 448 0
FLAG 224 400 sw
FLAG 224 560 0
FLAG 224 512 sw
FLAG 128 480 P_2
FLAG 368 480 N_2
FLAG 528 480 P_2
FLAG 528 592 N_2
SYMBOL ind 944 48 R0
SYMATTR InstName Lm1
SYMATTR Value {L_m}
SYMBOL cap 656 32 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cr1
SYMATTR Value {C_r}
SYMBOL ind 784 64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName Lr1
SYMATTR Value {L_r}
SYMBOL res 1152 48 R0
SYMATTR InstName Rac
SYMATTR Value {R_ac}
SYMBOL ind2 752 480 R0
SYMATTR InstName Ls1
SYMATTR Value {Ls/2}
SYMATTR Type ind
SYMBOL ind2 1008 480 M0
SYMATTR InstName Lp1
SYMATTR Value {Lp/2}
SYMATTR Type ind
SYMBOL res 1152 592 R0
SYMATTR InstName Rg1
SYMATTR Value 20Meg
SYMBOL res 1152 480 R0
SYMATTR InstName R0
SYMATTR Value {R_0}
SYMBOL cap 656 464 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cr2
SYMATTR Value {C_r}
SYMBOL res -160 160 R0
SYMATTR InstName Riso1
SYMATTR Value 20Meg
SYMBOL res -160 592 R0
SYMATTR InstName Riso2
SYMATTR Value 20Meg
SYMBOL voltage -144 -272 R0
SYMATTR InstName V4
SYMATTR Value PULSE(0 1 {t_onoff} {t_edge} {t_edge} {t_onoff} {T})
SYMBOL voltage -144 0 M0
SYMATTR InstName V1
SYMATTR Value {V_in}
SYMBOL sw 48 48 M180
SYMATTR InstName S1
SYMATTR Value HS
SYMBOL sw 48 160 M180
SYMATTR InstName S2
SYMATTR Value LS
SYMBOL voltage -144 432 M0
SYMATTR InstName V2
SYMATTR Value {V_in}
SYMBOL sw 272 48 M180
SYMATTR InstName S3
SYMATTR Value LS
SYMBOL sw 272 160 M180
SYMATTR InstName S4
SYMATTR Value Hs
SYMBOL sw 48 480 M180
SYMATTR InstName S5
SYMATTR Value HS
SYMBOL sw 48 592 M180
SYMATTR InstName S6
SYMATTR Value LS
SYMBOL sw 272 480 M180
SYMATTR InstName S7
SYMATTR Value LS
SYMBOL sw 272 592 M180
SYMATTR InstName S8
SYMATTR Value Hs
TEXT 1912 128 Left 2 !.tran 0 1.0125m 1m
TEXT 224 896 Left 2 !.param N = 35 / 4\n.param Lp = 500uH\n.param Llkg = 95uH\n.param Kf = sqrt(1 - (Llkg / Lp))\n.param Ls=Lp / (N**2)
TEXT 224 808 Left 2 ;https://www.analog.com/en/technical-articles/using-transformers-in-ltspice-switcher-cadiii.html
TEXT 224 832 Left 2 ;Datasheet:\nhttps://www.we-online.com/components/products/datasheet/760895641.pdf
TEXT 1912 184 Left 2 !; Input parameter\n.param U_bus_nom = 425V\n.param P_out_max = 400W\n.param f_r = 250kHz\n.param F_x = 1\n \n; Voltage source\n.param f = f_r * F_x\n.param T = 1 / f\n.param t_edge = 10n\n.param t_onoff = T / 2 - t_edge\n \n.param V_in = U_bus_nom / N\n.meas V_in_ PARAM V_in\n \n; LLC components\n.param L_r = Llkg / (N**2) / 2\n.meas L_r_ PARAM L_r\n \n.param L_m = (Lp - Llkg) / (N**2) / 2\n.meas L_m_ PARAM L_m\n \n.param R_0 = U_bus_nom**2 / P_out_max\n.meas R_0_ PARAM R_0\n \n.param R_ac = (8 / PI**2) / N**2 * R_0\n.meas R_ac_ PARAM R_ac\n \n.param C_r = 1 / (2 * PI* f_r)**2 / L_r\n.meas C_r_ PARAM C_r\n \n; Measurements\n.meas I_C RMS I(Cr1)  FROM 1e-5\n.meas I_V_in AVG I(V1)  FROM 1e-5\n.meas V_out RMS V(V_0)  FROM 1e-5\n.meas P_out RMS V(V_0)*I(R0)  FROM 1e-5\n.meas P_out2 RMS V(V_r)*I(Rac)  FROM 1e-5
TEXT 792 472 Left 2 !K1 Lp1 Ls1 {Kf}
TEXT 1368 488 Left 2 ;L[dB] = 20 * log(V_out / V_in)\nV = 10**(L/20)\nExpected: \nL = 20 * log(35/2) = 24.86dB
TEXT -144 -360 Left 2 !.model LS SW(Ron=100Meg Roff=1u Vt=.5)\n.model HS SW(Ron=1u Roff=100Meg Vt=.5)
