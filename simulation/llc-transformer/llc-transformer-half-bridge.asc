Version 4
SHEET 1 3940 1956
WIRE 304 -288 224 -288
WIRE 1072 -288 992 -288
WIRE 224 -256 224 -288
WIRE 992 -256 992 -288
WIRE 224 -144 224 -176
WIRE 992 -144 992 -176
WIRE 272 -64 224 -64
WIRE 416 -64 272 -64
WIRE 416 -48 416 -64
WIRE 224 16 224 -64
WIRE 416 48 416 32
WIRE 544 48 416 48
WIRE 672 48 544 48
WIRE 816 48 736 48
WIRE 976 48 896 48
WIRE 1152 48 976 48
WIRE 1184 48 1152 48
WIRE 416 64 416 48
WIRE 976 64 976 48
WIRE 1184 64 1184 48
WIRE 224 160 224 96
WIRE 288 160 224 160
WIRE 416 160 416 144
WIRE 416 160 288 160
WIRE 976 160 976 144
WIRE 976 160 416 160
WIRE 1184 160 1184 144
WIRE 1184 160 976 160
WIRE 224 176 224 160
WIRE 224 272 224 256
WIRE 400 352 224 352
WIRE 400 384 400 352
WIRE 224 448 224 352
WIRE 400 480 400 464
WIRE 528 480 400 480
WIRE 656 480 528 480
WIRE 768 480 720 480
WIRE 1120 480 992 480
WIRE 1168 480 1120 480
WIRE 400 496 400 480
WIRE 768 496 768 480
WIRE 992 496 992 480
WIRE 1168 496 1168 480
WIRE 224 592 224 528
WIRE 400 592 400 576
WIRE 400 592 224 592
WIRE 768 592 768 576
WIRE 768 592 400 592
WIRE 992 592 992 576
WIRE 1168 592 1168 576
WIRE 1168 592 992 592
WIRE 224 608 224 592
WIRE 1168 608 1168 592
WIRE 224 704 224 688
FLAG 224 272 0
FLAG 544 48 V_in_1
FLAG 1152 48 V_r
FLAG 1168 688 0
FLAG 528 480 V_in_2
FLAG 1120 480 V_0
FLAG 224 704 0
FLAG 288 160 GND1
FLAG 224 -144 0
FLAG 304 -288 LS
FLAG 368 16 0
FLAG 368 -32 HS
FLAG 368 128 0
FLAG 368 80 LS
FLAG 272 -64 v_in
FLAG 352 448 0
FLAG 352 400 HS
FLAG 352 560 0
FLAG 352 512 LS
FLAG 992 -144 0
FLAG 1072 -288 HS
SYMBOL ind 960 48 R0
SYMATTR InstName Lm1
SYMATTR Value {L_m}
SYMBOL cap 672 32 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cr1
SYMATTR Value {C_r}
SYMATTR SpiceLine Rser=1u
SYMBOL ind 800 64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName Lr1
SYMATTR Value {L_r}
SYMBOL res 1168 48 R0
SYMATTR InstName Rac
SYMATTR Value {R_ac}
SYMBOL ind2 752 480 R0
SYMATTR InstName Ls1
SYMATTR Value {Ls/2}
SYMATTR Type ind
SYMBOL ind2 1008 480 M0
SYMATTR InstName Lp1
SYMATTR Value {Lp/2}
SYMATTR Type ind
SYMBOL res 1152 592 R0
SYMATTR InstName Rg1
SYMATTR Value 20Meg
SYMBOL res 1152 480 R0
SYMATTR InstName R0
SYMATTR Value {R_0}
SYMBOL cap 656 464 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cr2
SYMATTR Value {C_r}
SYMATTR SpiceLine Rser=1u
SYMBOL res 208 160 R0
SYMATTR InstName Riso1
SYMATTR Value 20Meg
SYMBOL res 208 592 R0
SYMATTR InstName Riso2
SYMATTR Value 20Meg
SYMBOL voltage 224 -272 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value PULSE(0 1 0 {t_edge} {t_edge} {t_onoff} {T})
SYMBOL voltage 224 0 M0
SYMATTR InstName V1
SYMATTR Value {V_in}
SYMBOL sw 416 48 M180
SYMATTR InstName S1
SYMBOL sw 416 160 M180
SYMATTR InstName S2
SYMBOL sw 400 480 M180
SYMATTR InstName S3
SYMBOL sw 400 592 M180
SYMATTR InstName S4
SYMBOL voltage 224 432 M0
SYMATTR InstName V2
SYMATTR Value {V_in}
SYMBOL voltage 992 -272 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 1 {T / 2} {t_edge} {t_edge} {t_onoff} {T})
TEXT 1912 128 Left 2 !.tran 0 1.0125m 1m
TEXT 224 896 Left 2 !.param N = 35 / 2\n.param Lp = 500uH\n.param Llkg = 95uH\n.param Kf = sqrt(1 - (Llkg / Lp))\n.param Ls=Lp / (N**2)
TEXT 224 808 Left 2 ;https://www.analog.com/en/technical-articles/using-transformers-in-ltspice-switcher-cadiii.html
TEXT 224 832 Left 2 ;Datasheet:\nhttps://www.we-online.com/components/products/datasheet/760895631.pdf
TEXT 1912 184 Left 2 !; Input parameter\n.param U_bus_nom = 425V\n.param P_out_max = 400W\n.param f_r = 250kHz\n.param F_x = 1\n \n; Voltage source\n.param f = f_r * F_x\n.param T = 1 / f\n.param t_edge=100n\n.param t_dead=0\n.param t_onoff = T / 2 - t_edge - t_dead\n \n.param V_in = U_bus_nom / N * 2\n.meas V_in_ PARAM V_in\n \n; LLC components\n.param L_r = Llkg / (N**2) / 2\n.meas L_r_ PARAM L_r\n \n.param L_m = (Lp - Llkg) / (N**2) / 2\n.meas L_m_ PARAM L_m \n \n.param R_0 = U_bus_nom**2 / P_out_max\n.meas R_0_ PARAM R_0\n \n.param R_ac = (8 / PI**2) / N**2 * R_0\n.meas R_ac_ PARAM R_ac\n \n.param C_r = 1 / (2 * PI* f_r)**2 / L_r\n.meas C_r_ PARAM C_r\n \n; Measurements\n.meas I_C RMS I(Cr1)  FROM 1e-5\n.meas I_V_in AVG I(V1)  FROM 1e-5\n.meas V_out RMS V(V_0)  FROM 1e-5\n.meas P_out RMS V(V_0)*I(R0)  FROM 1e-5\n.meas P_out2 RMS V(V_r)*I(Rac)  FROM 1e-5
TEXT 792 472 Left 2 !K1 Lp1 Ls1 {Kf}
TEXT 1368 488 Left 2 ;L[dB] = 20 * log(V_out / V_in)\nV = 10**(L/20)\nExpected: \nL = 20 * log(35/2) = 24.86dB
TEXT 224 -360 Left 2 !.model SW SW(Ron=1u Roff=100Meg Vt=.5)
